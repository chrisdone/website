<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>The language of spreadsheets is bad</title>
    <style>
    h2 a,h3 a,h4 a,h5 a {
      text-decoration: none;
}
h2 a:hover,h3 a:hover,h4 a:hover,h5 a:hover {
      text-decoration: underline;
      color: #1a6e8e;
}

.footnote-back {
  margin-left: 0.5em;
}
      #footnotes li:target {
          background: #eeeeee;
          border-radius: 0.5em;
          padding: 1px 1em;
      }
      body {
      max-width: 40em;
      margin: .5in auto;
      font-size: 18px;
      font-family: serif;
      line-height: 1.5;
      }
      pre, code {
      font-size: 16px;
      word-wrap: break-word;
      }
      pre {
      padding-left: 1em;
      line-height: 1.5em;
      border-left: 5px solid #efefef;
      }
      a {
      color: #1a6e8e
      }
      .menu a {
      margin-right: 1em;
      }
      h1,h2,h3,h4,h5,h6 {
      font-family: Helvetica;
      }

      h1 a,h2 a,h3 a,h4 a {
      color: inherit;
      }

      .post-1,.post-2{
      margin-bottom: 0.5em;
      }

      .author {
      display: none;
      }

      footer {
      margin-top: 1.5em;
      padding-top: 1.5em;
          border-top: 1px solid #ccc;
      margin-bottom: 2em
      }
    hr {
  border: 0.5px solid #ccc;
}

      footer span {
      display: none;
      }

      img {
      max-width: 100%
      }
      pre.sourceCode span.st {
      color: #366354
      }
      pre.sourceCode span.kw {
      color: #397460
      }
      pre.sourceCode span.fu {
      color: #8f4e8b
      }
      pre.sourceCode span.ot {
      color: #2e659c
      }
      pre.sourceCode span.dt {
      color: #4F4371
      }
      pre.sourceCode span.co {
      color: #666
      }
      @media(max-width:767px){
      body { margin: 1px 4px; }
      h1, h2, .menu { margin: 0; }
      h1 { font-size: 1.5em; }
      h2 { font-size: 1.125em; }
      h3 { font-size: 1.0125em; }
      .menu a { margin-right: 0.1em; }
      #archive { margin-left: 1em; margin-top: 0; padding: 0}
      #archive .post-1, #archive .post-2 {
      margin-bottom: 0.1em;
      }
      }
      .footnote-ref { text-decoration: none; }
      li { margin-top: 0.5em; margin-bottom: 0.5em; }
    </style>
  </head>
  <body>
    <div class="page-wrap">

<h1>The language of spreadsheets is bad</h1>

<p>The user interface in a spreadsheet is modal. There are two
modes:</p>
<ul>
<li>The first mode is <strong>code</strong> (also known as: formula):
<code>=SUM(A1:A5)</code></li>
<li>The second mode is the <strong>result</strong> of running that code:
<code>234</code></li>
</ul>
<p>You type in some equation, some mathematics, some conditions, and
then you hit return, and then you see the results.</p>
<h2 id="declarative-programming-is-a-good-fit">Declarative programming
is a good fit</h2>
<p>The programming language that you write your code in is a declarative
programming language. We call programming languages declarative when you
say what you want (declarative) more than instructing the computer how
to go about achieving it (imperative). When languages are declarative,
it gives the system more freedom to make choices about how to go about
computing results.</p>
<p>The code in spreadsheets is this kind of language. It has to be. When
you change code in one cell, all the other cells are updated. If the
language was imperative, that would mean it could change things. That’s
bad when cells are re-run all the time during your course of work. It’d
be chaos to keep track of what you changed.</p>
<p>That’s why the language must be declarative, to give the system
freedom to run formulae whenever it needs to without worrying about side
effects. On VisiCalc, the first spreadsheet software from 1979, Ted
Nelson said:</p>
<p>“VISICALC represented a new idea of a way to use a computer and a new
way of thinking about the world. Where conventional programming was
thought of as a sequence of steps, this new thing was no longer
sequential in effect: When you made a change in one place, all other
things changed instantly and automatically.”</p>
<h2 id="thats-where-it-ends">That’s where it ends</h2>
<p>However, it’s quite a limited programming language. It was initially
designed to handle a small subset of problems that you might encounter
in finance. It has been extended with plenty of functions like
trigonometric functions and things like that, but without any particular
rigour or academic insight or critical eye.</p>
<p>It’s very convenient for simple problems, dealing with simple
numbers, text and dates. However, any programmer can tell you
immediately that there are limitations to this language. And indeed any
Excel or Google Sheets user can tell you that they have hit the limits
of this language often.</p>
<h2 id="the-solutions-arent-solutions">The solutions aren’t
solutions</h2>
<p>When you hit the limits of the spreadsheets expression language,
there are two approaches:</p>
<ul>
<li>The first is to try to remodel your problem to avoid the limitation,
this is really just a hack/kludge.</li>
<li>The other is to simply abandon this language and use either Visual
Basic or JavaScript, or Python, or some other general purpose
programming language that has the power to express what you really
wanted to express in the first place. This is typically called
“scripting”.</li>
</ul>
<p>The first approach is not a solution.</p>
<p>For the second, there are two solid problems with this approach:</p>
<ul>
<li>The first problem is that you are no longer using the original
language and therefore you have to keep two languages in sync and in
your head.</li>
<li>You have to work with two completely different programming
paradigms, because all of the mainstream scripting languages are
imperative.</li>
</ul>
<p>You have lost the declarative nature of what makes spreadsheets
great. You also have to learn a new language.</p>
<p>If you were a normal spreadsheet user, with a full plate of work, the
chances of actually learning Visual Basic or Python on your own time are
very slim.</p>
<p>So, probably, you’ll have to ask a “programmer” to solve your problem
for you, which is really annoying. A wise person once said: in
computing, there is nothing worse than a computer telling you that you
cannot express a thought.</p>
<h2 id="wizard-politics">Wizard politics</h2>
<p>This creates a funny class system of “muggles and wizards”, to borrow
a Harry Potter term, wherein the millions of users of spreadsheets are
the muggles that make do with rudimentary tools, and the wizards are a
privileged class with all the power. Modern offerings like AirTable
continue this narrative: in the community forums, I have read this
comment by a community leader:</p>
<blockquote>
<p>I don’t recommend attempting this using a formula field. Look into a
scripting solution—either in the Scripting app, or in a “Run script”
action in an automation—where you can tap into the built-in sorting
features of the JavaScript language.</p>
</blockquote>
<p>It also makes bad sense from a business perspective; I paid for a
tool for all my employees, and now my employees are asking for
developers to do something that the tool should be able to do already.
My employees are wasted even though they are perfectly good at their
domain and are willing.</p>
<p>We are also faced with a secondary problem, which is the problem of
choice. You have to choose where to put your logic, either in the
spreadsheet or in the scripting language. Now you have two problems.</p>
<h2 id="lets-call-a-spade-a-spade">Let’s call a spade a spade</h2>
<p>The elephant in the room is simply that the expression language in
spreadsheets is insufficient, not up to the task, not up to snuff,
including for people who aren’t programmers or engineers. Hybridisation
does not work well to paper over this issue either.</p>
<p>This is also omitting other criticisms, like a lack of first-class
functions, which would make awkward abominations like
<code>VLOOKUP</code> and friends unnecessary.</p>
<p>We also know that this language simply does not scale. People write
god-awful messes of <code>IF(IF(..))</code> expressions that fill a
whole screen in one cell. Formulae are duplicated across ranges and then
accidentally modified only in some of them. It’s the wild west.</p>
<h2 id="there-is-already-a-better-language">There is already a better
language</h2>
<p>The good news is that for 35 years there has been in development
so-called <em>pure functional programming languages</em>, which are
declarative languages which have the power of general purpose languages
like Visual Basic, yet retain the declarative purity that we enjoy in
spreadsheets.</p>
<p>The most popular incarnation of this is called Haskell. It has a
static type system which prevents some issues. It has a well-developed,
comprehensive set of functions for expressing common problems like
loops, filters, reductions, etc.</p>
<p>Unlike your Visual Basics, your Pythons, your JavaScripts, Haskell
knows how to express normal every day programming problems in a
functional declarative way, and that is what makes it a perfect
candidate replacement language for spreadsheets.</p>
<p>Haskell also has something to say about dealing with time (think:
<code>=NOW()</code>), streams (think reading data from external
systems), events (think button clicks) and the rest in a pure language.
Spreadsheet systems side-step the whole issue (and miss a huge
opportunity), opting to simply call these “volatile” cells that may
change in a variety of ad hoc cases, but we’ll see more about that in
another future article.</p>
<h2 id="conclusion">Conclusion</h2>
<p>In conclusion, there’s no point trying to maintain a hybrid approach
of using a very restricted language combined with an imperative
language, when you could go straight to the obvious solution and use a
real, functional, powerful language from the beginning, which has been
tried and tested for 35 years, and is easily up to the task of
expressing spreadsheet problems. There is also an optimising compiler
that can compile it to machine code to run very quickly.</p>
<p>You can educate people in a tool to do simple arithmetic and filters
very easily, I’ve done it. But the key addition is that you can level up
in the same language to do more complex things. There’s a progression
path.</p>
<p>Our Inflex language is built from the ground up based on Haskell
(with lessons from PureScript, Unison and OCaml). It’s designed to be
run in a reactive document, to deal with numbers, records, lists,
tables, etc. and in the future, streams. At the time of writing, we’re
in an invite-only beta, but we’ll be documenting more of that language
over time.</p>


<footer>
  <table style="width:100%">
    <tr>
      <td>© 2020-11-13 <a href="/">Chris Done</a></td>
      <td style="text-align:right"><a href="/posts">Read more posts →</a></td>
    </tr>
  </table>
</footer>

    </div>
    <script>
    var headers = document.querySelectorAll('h2, h3, h4, h5');
    headers.forEach(function(header) {
        var headerId = header.id;
        if (headerId) {
            var anchor = document.createElement('a');
            anchor.href = '#' + headerId;
            anchor.textContent = header.textContent;
            header.textContent = '';
            header.appendChild(anchor);
        }
    });
    </script>
  </body>
</html>
